{% extends 'base.html' %}
{% load static %}

{% block 'cabecalho' %}
<!-- Google Maps -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCj2Tn5LiWlTUgevFKlQ7aUku8ZxYyjyXM"></script>

{% endblock %}
{% block 'conteudo' %}
<div class="container">
    <div class="row">
        <div class="col-sm-6 mt-3">
          <div id="map" style="height: 500px;width: 1000px; display: block; border-radius: 10px;"></div>
        </div>        
    </div>
    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" onclick="openModal('mdlMapa')" style="border-radius: 10px !important;">
        Launch demo modal
    </button>
    
    <div class="modal altura-modal-topo" id="mdlMapa" tabindex="-1" data-bs-backdrop="static"
    data-bs-keyboard="false" aria-labelledby="staticBackdropLabel" 
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable margin-topo-modal" >  
      <div class="modal-content">
        <div class="modal-header cabecalho-modal-parceiro">
          <h5 class="modal-title">Mapas Coletas</h5>
          <div>
            <div class="input-group" align="right">
              <button type="button" class="btn btn-secondary btn-rounded btn-icon" id="btnLimpaParceiros" align=right>            
                <i class="ti-write"></i>
              </button>
              <button type="button" class="btn btn-success btn-rounded btn-icon" id="salvaParceiro" align=right>            
                <i class="ti-save"></i>
              </button>
              <button type="button" class="btn btn-danger btn-rounded btn-icon" id="btnClose" onclick="closeModal()" align=right>
                <i class="ti-close"></i>
              </button>
            </div>
          </div>  
        </div>
        <div class="corpo-modal-parceiros modal-body">
            <div id="map" style="height: 500px; display: block;"></div>
        </div>
    </div>
  </div>


</div>
<script>
    const geraCoordenadas = ()=>{
        // Coordenadas aproximadas para São Paulo e Grande São Paulo
        var saoPauloBounds = {
            north: -23.356792,
            south: -23.7452,
            west: -46.825123,
            east: -46.365582
        };

        // Número de linhas e colunas para a grade
        var rows = 6;
        var cols = 10;

        // Calcula o intervalo de latitude e longitude
        var latInterval = (saoPauloBounds.north - saoPauloBounds.south) / rows;
        var lngInterval = (saoPauloBounds.east - saoPauloBounds.west) / cols;

        // Lista para armazenar as coordenadas geradas
        var coordenadas = [];

        // Loop para gerar as coordenadas da grade
        for (var i = 0; i < rows; i++) {
            for (var j = 0; j < cols; j++) {
                // Calcula as coordenadas para o ponto na grade
                var lat = saoPauloBounds.south + latInterval * i + Math.random() * latInterval * 0.8;
                var lng = saoPauloBounds.west + lngInterval * j + Math.random() * lngInterval * 0.8;
                coordenadas.push([lat, lng]);
            }
        }

        // Exibe as coordenadas geradas
        return coordenadas ;
    }

    function initMap() {
    // Coordenadas iniciais
    var myLatLng = { lat: -23.47337308, lng: -46.47320867 };

    // Cria um novo mapa do Google
    var map = new google.maps.Map(document.getElementById('map'), {
        center: myLatLng,
        zoom: 10.3 // Ajuste o zoom conforme necessário
    });

    // Obtém as coordenadas geradas pela função geraCoordenadas
    var coordenadasGeradas = geraCoordenadas();

    // Define o tamanho do ícone do marcador
    var iconSize = {
        width: 20, // Largura desejada em pixels
        height: 20 // Altura desejada em pixels
    };

    // Adiciona marcadores para cada conjunto de coordenadas
    coordenadasGeradas.forEach(function(coordenadas) {
        var marker = new google.maps.Marker({
            position: { lat: coordenadas[0], lng: coordenadas[1] },
            map: map,
            icon: {
                url:"{% static 'images/mapasIcones/localizacaoVermelho.png' %}", // URL do ícone do marcador
                scaledSize: new google.maps.Size(iconSize.width, iconSize.height) // Tamanho do ícone escalado
            }
        });
    });
}


        // Chame a função initMap quando a página for carregada
        google.maps.event.addDomListener(window, 'load', initMap);
</script>

{% endblock %}

{% block js %} 

{% endblock %}