{% extends 'base.html' %}
{% load static %}

{% block 'cabecalho' %}
<!-- Google Maps -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCj2Tn5LiWlTUgevFKlQ7aUku8ZxYyjyXM"></script>

{% endblock %}
{% block 'conteudo' %}
<div>
    <div class="row">
      <div class="card col-sm-8">
        <div class="card-body">
          <div id="map" style="height: 500px;border-radius: 10px;"></div>
        </div>
      </div>
      <div class="col-sm-4 pl-0 mt-0">
        <div class="card">
          <div class="card-body">
            <ul class="nav nav-tabs" role="tablist">
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="home-tab" data-bs-toggle="tab" href="#home-1" role="tab" aria-controls="home-1" aria-selected="false" tabindex="-1">Home</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="profile-tab" data-bs-toggle="tab" href="#profile-1" role="tab" aria-controls="profile-1" aria-selected="false" tabindex="-1">Profile</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link active" id="contact-tab" data-bs-toggle="tab" href="#contact-1" role="tab" aria-controls="contact-1" aria-selected="true">Contact</a>
              </li>
            </ul>
            <div class="tab-content">
              <div class="tab-pane fade" id="home-1" role="tabpanel" aria-labelledby="home-tab">
                <div class="media">
                  <img class="me-3 w-25 rounded" src="../../../assets/images/samples/300x300/13.jpg" alt="sample image">
                  <div class="media-body">
                    <div class="table-responsive">
                      <table class="table table-striped table-borderless">
                        <thead>
                          <tr>
                            <th>Product</th>
                            <th>Status</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>459094</td>
                            <td class="font-weight-medium">
                                <div class="badge badge-success">Completed</div>
                            </td>
                          </tr>
                          <tr>
                            <td>Search Engine Optimization</td>
                            <td class="font-weight-medium">
                              <div class="badge badge-success">Completed</div>
                            </td>
                          </tr>
                          <tr>
                            <td>28 Sep 2018</td>
                            <td class="font-weight-medium">
                              <div class="badge badge-warning">Pending</div>
                            </td>
                          </tr>
                          <tr>
                            <td>30 Jun 2018</td>
                            <td class="font-weight-medium">
                              <div class="badge badge-warning">Pending</div>
                            </td>
                          </tr>
                          <tr>
                            <td>01 Nov 2018</td>
                            <td class="font-weight-medium">
                              <div class="badge badge-danger">Cancelled</div>
                            </td>
                          </tr>
                          <tr>
                            <td>20 Mar 2018</td>
                            <td class="font-weight-medium">
                              <div class="badge badge-warning">Pending</div>
                            </td>
                          </tr>
                          <tr>
                            <td>26 Oct 2018</td>
                            <td class="font-weight-medium">
                              <div class="badge badge-success">Completed</div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade" id="profile-1" role="tabpanel" aria-labelledby="profile-tab">
                <div class="media">
                  <img class="me-3 w-25 rounded" src="../../../assets/images/faces/face12.jpg" alt="sample image">
                  <div class="media-body">
                    <h4 class="mt-0">John Doe</h4>
                    <p>
                      Fail most room even gone her end like. Comparison dissimilar unpleasant six compliment two
                      unpleasing
                      any add. Ashamed my company thought wishing colonel it prevent he in. Pretended residence
                      are something
                      far engrossed old off.
                    </p>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade active show" id="contact-1" role="tabpanel" aria-labelledby="contact-tab">
                <h4>Contact us </h4>
                <p>
                  Feel free to contact us if you have any questions!
                </p>
                <p>
                  <i class="ti-headphone-alt text-info"></i>
                  +123456789
                </p>
                <p>
                  <i class="ti-email text-success"></i>
                  contactus@example.com
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>
<script>
    const geraCoordenadas = ()=>{
        // Coordenadas aproximadas para São Paulo e Grande São Paulo
        var saoPauloBounds = {
            north: -23.356792,
            south: -23.7452,
            west: -46.825123,
            east: -46.365582
        };

        // Número de linhas e colunas para a grade
        var rows = 6;
        var cols = 10;

        // Calcula o intervalo de latitude e longitude
        var latInterval = (saoPauloBounds.north - saoPauloBounds.south) / rows;
        var lngInterval = (saoPauloBounds.east - saoPauloBounds.west) / cols;

        // Lista para armazenar as coordenadas geradas
        var coordenadas = [];

        // Loop para gerar as coordenadas da grade
        for (var i = 0; i < rows; i++) {
            for (var j = 0; j < cols; j++) {
                // Calcula as coordenadas para o ponto na grade
                var lat = saoPauloBounds.south + latInterval * i + Math.random() * latInterval * 0.8;
                var lng = saoPauloBounds.west + lngInterval * j + Math.random() * lngInterval * 0.8;
                coordenadas.push([lat, lng]);
            }
        }

        // Exibe as coordenadas geradas
        return coordenadas ;
    }

    function initMap() {
    // Coordenadas iniciais
    var myLatLng = { lat: -23.47337308, lng: -46.47320867 };

    // Cria um novo mapa do Google
    var map = new google.maps.Map(document.getElementById('map'), {
        center: myLatLng,
        zoom: 10.3 // Ajuste o zoom conforme necessário
    });

    // Quando o mapa estiver pronto, execute o código dentro desta função
    google.maps.event.addListenerOnce(map, 'tilesloaded', function() {
        // Obtém as coordenadas geradas pela função geraCoordenadas
        var coordenadasGeradas = geraCoordenadas();

        // Adiciona uma div para cada conjunto de coordenadas
        coordenadasGeradas.forEach(function(coordenadas) {
            // Converte as coordenadas geográficas em coordenadas de pixel
            var pixelPosition = latLngToPixel(coordenadas[0], coordenadas[1], map);

            // Cria a div com a classe e o texto desejados
            var div = document.createElement('div');
            div.className = 'badge badge-success'; // Classe da div
            div.innerHTML = 'Completed'; // Texto da div

            // Estilo da div
            div.style.position = 'absolute'; // Posição absoluta
            div.style.left = (pixelPosition.x - 10) + 'px'; // Ajuste de posição X para centralizar
            div.style.top = (pixelPosition.y - 10) + 'px'; // Ajuste de posição Y para centralizar

            // Adiciona a div ao mapa
            map.getDiv().appendChild(div);
        });
    });
}

// Função para converter coordenadas de latitude e longitude em coordenadas de pixel
function latLngToPixel(lat, lng, map) {
    var scale = Math.pow(2, map.getZoom());
    var proj = map.getProjection();
    var bounds = map.getBounds();

    var nw = proj.fromLatLngToPoint(
        new google.maps.LatLng(
            bounds.getNorthEast().lat(),
            bounds.getSouthWest().lng()
        )
    );

    var point = proj.fromLatLngToPoint(new google.maps.LatLng(lat, lng));
    return { x: Math.floor((point.x - nw.x) * scale), y: Math.floor((point.y - nw.y) * scale) };
}






        // Chame a função initMap quando a página for carregada
        google.maps.event.addDomListener(window, 'load', initMap);
</script>

{% endblock %}

{% block js %} 

{% endblock %}